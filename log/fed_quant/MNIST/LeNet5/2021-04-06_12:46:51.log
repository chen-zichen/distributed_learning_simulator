2021-04-06 12:46:51,545 INFO {thd:140445882263360} [arg_parse.py => 72] : use dataset MNIST and model LeNet5
2021-04-06 12:47:06,343 INFO {thd:140443338397248} [trainer.py => 144] : training_set_size is 49995
2021-04-06 12:47:06,344 INFO {thd:140443338397248} [trainer.py => 148] : use device cuda:0
2021-04-06 12:47:06,344 INFO {thd:140445882263360} [simulator.py => 52] : begin training
2021-04-06 12:47:08,893 INFO {thd:140443338397248} [trainer.py => 359] : begin training, hyper_parameter is epochs:1 batch_size:64 learning_rate:0.01 weight_decay:1 optimizer:<class 'torch.optim.sgd.SGD'>, optimizer is SGD (
Parameter Group 0
    dampening: 0
    lr: 0.01
    momentum: 0.9
    nesterov: False
    weight_decay: 2.0002000200020003e-05
) ,lr_scheduler is <torch.optim.lr_scheduler.ReduceLROnPlateau object at 0x7fbb9ee42950>, model: QuantedModel, loss_fun: NLLLoss(), parameter number is 61706
2021-04-06 12:47:09,412 INFO {thd:140443338397248} [trainer.py => 375] : epoch: 1, batch: 0, learning rate: [0.01], batch training loss: 2.282348394393921
2021-04-06 12:47:14,590 INFO {thd:140443338397248} [trainer.py => 375] : epoch: 1, batch: 78, learning rate: [0.01], batch training loss: 1.9773156642913818
2021-04-06 12:47:19,751 INFO {thd:140443338397248} [trainer.py => 375] : epoch: 1, batch: 156, learning rate: [0.01], batch training loss: 0.43531370162963867
2021-04-06 12:47:25,084 INFO {thd:140443338397248} [trainer.py => 375] : epoch: 1, batch: 234, learning rate: [0.01], batch training loss: 0.33195286989212036
2021-04-06 12:47:30,459 INFO {thd:140443338397248} [trainer.py => 375] : epoch: 1, batch: 312, learning rate: [0.01], batch training loss: 0.18471543490886688
2021-04-06 12:47:35,843 INFO {thd:140443338397248} [trainer.py => 375] : epoch: 1, batch: 390, learning rate: [0.01], batch training loss: 0.05556965246796608
2021-04-06 12:47:41,212 INFO {thd:140443338397248} [trainer.py => 375] : epoch: 1, batch: 468, learning rate: [0.01], batch training loss: 0.15077874064445496
2021-04-06 12:47:45,693 INFO {thd:140443338397248} [trainer.py => 375] : epoch: 1, batch: 546, learning rate: [0.01], batch training loss: 0.09141205251216888
2021-04-06 12:47:49,614 INFO {thd:140443338397248} [trainer.py => 375] : epoch: 1, batch: 624, learning rate: [0.01], batch training loss: 0.04562430828809738
2021-04-06 12:47:53,392 INFO {thd:140443338397248} [trainer.py => 375] : epoch: 1, batch: 702, learning rate: [0.01], batch training loss: 0.016821181401610374
2021-04-06 12:47:57,386 INFO {thd:140443338397248} [trainer.py => 375] : epoch: 1, batch: 780, learning rate: [0.01], batch training loss: 0.15150906145572662
2021-04-06 12:47:57,547 INFO {thd:140443338397248} [trainer.py => 397] : epoch: 1, training loss: 0.46528505013458515
2021-04-06 12:47:58,850 INFO {thd:140443338397248} [inference.py => 62] : use device cuda
2021-04-06 12:48:09,257 INFO {thd:140443338397248} [trainer.py => 426] : epoch: 1, learning_rate: [0.01], validation loss: 0.08559781312942505, accuracy = 0.975712143928036
2021-04-06 12:48:10,408 INFO {thd:140443338397248} [inference.py => 62] : use device cuda
2021-04-06 12:48:21,485 INFO {thd:140443338397248} [trainer.py => 475] : epoch: 1, learning_rate: [0.01], test loss: 0.07394467294216156, accuracy = 0.9765
2021-04-06 12:48:21,589 DEBUG {thd:140443338397248} [trainer.py => 292] : call ReduceLROnPlateau for total loss 0.5508828632640101
2021-04-06 12:48:22,749 INFO {thd:140443338397248} [inference.py => 62] : use device cuda
2021-04-06 12:48:22,749 ERROR {thd:140443338397248} [executor_pool.py => 37] : catch exception:'Conv2d' object has no attribute '_modules'
2021-04-06 12:48:22,755 ERROR {thd:140443338397248} [executor_pool.py => 38] : traceback:Traceback (most recent call last):
  File "/home/cicie/.local/lib/python3.7/site-packages/cyy_naive_lib-0.1-py3.7.egg/cyy_naive_lib/data_structure/executor_pool.py", line 35, in process
    fn(*args, **kwargs)
  File "/home/cicie/distributed_learning_simulator/fed_quant_worker.py", line 52, in train
    res = inferencer.inference()
  File "/home/cicie/.local/lib/python3.7/site-packages/cyy_naive_pytorch_lib-0.1-py3.7.egg/cyy_naive_pytorch_lib/inference.py", line 127, in inference
    loss = super().inference(**kwargs)
  File "/home/cicie/.local/lib/python3.7/site-packages/cyy_naive_pytorch_lib-0.1-py3.7.egg/cyy_naive_pytorch_lib/inference.py", line 63, in inference
    self.__model_with_loss.set_model_mode(self.__phase)
  File "/home/cicie/.local/lib/python3.7/site-packages/cyy_naive_pytorch_lib-0.1-py3.7.egg/cyy_naive_pytorch_lib/model_loss.py", line 53, in set_model_mode
    self.model.eval()
  File "/home/cicie/miniconda/envs/fedml/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1293, in eval
    return self.train(False)
  File "/home/cicie/miniconda/envs/fedml/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1277, in train
    module.train(mode)
  File "/home/cicie/miniconda/envs/fedml/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1277, in train
    module.train(mode)
  File "/home/cicie/miniconda/envs/fedml/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1277, in train
    module.train(mode)
  File "/home/cicie/miniconda/envs/fedml/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1276, in train
    for module in self.children():
  File "/home/cicie/miniconda/envs/fedml/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1172, in children
    for name, module in self.named_children():
  File "/home/cicie/miniconda/envs/fedml/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1190, in named_children
    for name, module in self._modules.items():
  File "/home/cicie/miniconda/envs/fedml/lib/python3.7/site-packages/torch/nn/modules/module.py", line 779, in __getattr__
    type(self).__name__, name))
torch.nn.modules.module.ModuleAttributeError: 'Conv2d' object has no attribute '_modules'

2021-04-06 12:48:22,756 INFO {thd:140445882263360} [simulator.py => 54] : end training
